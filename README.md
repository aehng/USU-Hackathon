# ğŸ©º VoiceHealth Tracker
Voice-activated health logging with automatic trigger detection and flare-up prediction. Speak your symptoms, skip the forms. The app finds patterns you'd never notice yourself.

## ğŸ‘¥ Team
| Person | Role |
|---|---|
| Eli | Frontend â€” Voice UI + Log Screen + Project Coordination |
| Noah | Backend â€” Local LLM Integration + Cloudflare Tunnels + API Routes |
| Clayton | Backend â€” Database Schema + Analysis Engine |
| Max | Frontend & Validation â€” Dashboard + Charts + C-based JSON Filter |

## ğŸ—ï¸ Stack
| Layer | Tech | Why |
|---|---|---|
| Frontend | React + Vite | Fast setup, works on any phone browser |
| Backend | FastAPI (Python) | Same language as LLM work, auto-generates API docs |
| Database | PostgreSQL 15 | Handles array types natively (symptom/trigger lists) |
| Voice | Web Speech API | Built into Chrome/Edge, zero setup, no API cost |
| LLM | Local LLM via Cloudflare | Noah runs the model locally, securely tunneled to the app |
| Validation | Custom C Filter | Max's custom C filter strictly validates LLM JSON formatting |
| Runtime | Docker Compose | Everyone runs the same environment |

âš ï¸ Web app, not Android. A React app works on every phone browser and deploys in seconds. Building an APK in 20 hours is a trap.
âš ï¸ Chrome or Edge only for voice recording. Web Speech API does not work in Firefox.

## ğŸ”’ Security & Data Note
**User authentication must be implemented.** Ensure that individual user data streams and histories are strictly separated and never mixed across different sessions or accounts to protect user privacy.

## ğŸŒ VM Access
Update this once the VM is set up Friday:

| Service | Address |
|---|---|
| VM IP | 192.168.x.x â† fill in when known |
| Frontend | http://192.168.x.x:5173 |
| Backend API | http://192.168.x.x:8001 |
| API Docs | http://192.168.x.x:8001/docs (auto-generated by FastAPI) |
| LLM Tunnel | https://your-cloudflare-tunnel.trycloudflare.com (Noah's Laptop) |
| SSH | ssh youruser@192.168.x.x |
Voice-activated health logging with automatic trigger detection and flare-up prediction. Speak your symptoms, skip the forms. The app finds patterns you'd never notice yourself.

## ğŸ‘¥ Team
| Person | Role |
|---|---|
| Eli | Frontend â€” Voice UI + Log Screen + Project Coordination |
| Noah | Backend â€” Local LLM Integration + Cloudflare Tunnels + API Routes |
| Clayton | Backend â€” Database Schema + Analysis Engine |
| Max | Frontend & Validation â€” Dashboard + Charts + C-based JSON Filter |

## ğŸ—ï¸ Stack
| Layer | Tech | Why |
|---|---|---|
| Frontend | React + Vite | Fast setup, works on any phone browser |
| Backend | FastAPI (Python) | Same language as LLM work, auto-generates API docs |
| Database | PostgreSQL 15 | Handles array types natively (symptom/trigger lists) |
| Voice | Web Speech API | Built into Chrome/Edge, zero setup, no API cost |
| LLM | Local LLM via Cloudflare | Noah runs the model locally, securely tunneled to the app |
| Validation| Custom C Filter | Max's custom C filter strictly validates LLM JSON formatting |
| Runtime | Docker Compose | Everyone runs the same environment |

âš ï¸ Web app, not Android. A React app works on every phone browser and deploys in seconds. Building an APK in 20 hours is a trap.
âš ï¸ Chrome or Edge only for voice recording. Web Speech API does not work in Firefox.

## ğŸ”’ Security & Data Note
**User authentication must be implemented.** Ensure that individual user data streams and histories are strictly separated and never mixed across different sessions or accounts.

## ğŸŒ VM Access
Update this once the VM is set up Friday:

| Service | Address |
|---|---|
| VM IP | 192.168.1.9 |
| Frontend | http://192.168.1.9:5173 |
| Backend API | http://192.168.1.9:8001 |
| API Docs | http://192.168.1.9:8001/docs (auto-generated by FastAPI) |
| LLM Tunnel | https://your-cloudflare-tunnel.trycloudflare.com (Noah's Laptop) |
| SSH | ssh ubunto@192.168.1.9 |

### ğŸ”Œ Port Allocations
To avoid Docker collisions, the team is strictly using the following ports on the VM:
| Port | Service | Owner | Description |
|---|---|---|---|
| `3000` | Frontend | Eli/Max | React Vite Development Server |
| `5433` | Database | Clayton | PostgreSQL Connection |
| `8000` | Tunnel | Noah | Reserved for Cloudflare LLM Tunnel |
| `8001` | Backend API | Noah/Clayton | FastAPI Web Server |

## ğŸ—„ï¸ Database Schema

The PostgreSQL schema is defined in `db/init.sql` and includes the following tables:
| Table | Description |
|---|---|
| `users` | Stores users (dummy user provided). |
| `entries` | Stores raw logs, extracted arrays (`symptoms`, `potential_triggers`), and severity. Indexed for fast querying. |
| `correlations` | Tracks statistical relationships between symptoms and triggers, including correlation scores and sample sizes. |
| `insights_cache` | Stores pre-computed insights as JSON. Noah writes to this asynchronously after the LLM extracts structured data to prevent locking up the UI. |

## ğŸ›ï¸ Architecture

```text
[User's Phone â€” Chrome Browser]
        |
   Speaks into mic â†’ Web Speech API converts to text
        |
[React Frontend]
        |
        | POST /api/log  (sends raw transcript)
        â†“
[FastAPI Backend]
        |              |
        â†“              â†“
  [PostgreSQL]    [Local LLM via Cloudflare]
    stores           extracts structured data:
    entries          symptoms, severity, triggers, mood
                     also generates follow-up questions
        |            â†“
        |         [C-based JSON Filter (Max)]
        |            validates formatting
        â†“
[Analysis Engine]
  queries DB, runs correlations, finds patterns
        |
        â†“
[Dashboard â€” React]
  shows insight cards, charts, trigger heatmap, predictions
```

## ğŸ”€ How Development Works
Everyone codes on their own laptop in their own editor. The VM is just the shared server.
Git is your sync mechanism. Docker is the runtime.

```text
Your Laptop (VSCode)
  â†’ write code
  â†’ git push to GitHub
  
VM
  â†’ git pull from GitHub
  â†’ docker compose up --build
  â†’ app live at 192.168.x.x
```

* **Frontend devs (Eli + Max):** Run Vite locally on your laptop, pointed at the VM's backend. You'll see changes instantly without touching the VM.
* **Backend devs (Noah + Clayton):** Run FastAPI locally, pointed at the VM's Postgres. Or run everything on the VM via Docker. Ensure Cloudflare tunnels route properly to Noah's local LLM.
* **Pulling to the VM:** Manual every 20-30 minutes is fine. No need to over-engineer this.

---

## ğŸŒ¿ Branch Strategy
| Branch | Owner |
|---|---|
| `main` | Stable â€” what the VM runs |
| `eli/voice-ui` | Eli |
| `noah/llm-backend` | Noah |
| `clayton/db-analysis` | Clayton |
| `max/dashboard` | Max |

Merge to `main` when something works end-to-end. VM pulls from `main`.

---

## ğŸ“¡ API Contract
These are the endpoints everyone depends on. Agree on these shapes early â€” don't change them without telling the team.

| Method | Route | Owner | Description |
|---|---|---|---|
| GET | `/api/health` | Noah | Health check â€” VM is up |
| POST | `/api/log/quick` | Noah | Log entry, return extracted data + trigger async insight computation |
| POST | `/api/log/guided/start` | Noah | Return extracted JSON state + follow-up questions (prevents re-extraction) |
| POST | `/api/log/guided/finalize` | Noah | Incremental LLM update (not full re-extraction), write entry, trigger async insight computation |
| GET | `/api/insights/{user_id}` | Noah | Return pre-computed insights from cache (instant, no LLM call). If < 5 entries, return "not enough data" message. |
| GET | `/api/stats/{user_id}` | Clayton | Return raw correlation stats for charts. If < 5 entries, return "not enough data" message. |
| GET | `/api/entries/{user_id}` | Clayton | Paginated entry history |

---

## ğŸ“‹ JSON Contract
**Noah, Clayton, and Max must agree on this by 7pm Friday.**

This is the shape of:
1. A logged entry (what gets stored)
2. The stats output that Clayton produces
3. The exact field names Max's charts expect (so Clayton can map his output correctly)

### Entry (what gets stored):
```json
{
  "user_id": "uuid",
  "raw_transcript": "string",
  "symptoms": ["symptom1", "symptom2"],
  "severity": 1-10,
  "potential_triggers": ["caffeine", "stress"],
  "mood": "string or null",
  "body_location": ["head", "stomach"],
  "time_context": "morning",
  "notes": "string",
  "logged_at": "timestamp"
}
```

### Stats output (Clayton â†’ cached insights & charts):
```json
{
  "trigger_correlations": [
    {"symptom": "headache", "trigger": "caffeine", "score": 0.75, "sample_size": 14}
  ],
  "temporal_patterns": [
    {"symptom": "fatigue", "peak_day": "Monday", "peak_time": "morning", "frequency": 8}
  ],
  "severity_trends": [
    {"symptom": "headache", "trend": "worsening", "slope": 0.35, "data_points": 14}
  ],
  "total_entries": 42,
  "date_range_days": 30
}
```

âš ï¸ **If total_entries < 5:** Both endpoints return a "not enough data" message instead. This prevents crashes and hallucination.

### Mapped chart data (Max dictates, Clayton implements):
**Max specifies exactly what field names his Recharts components need.**

Example â€” if Max's severity chart expects this shape:
```json
[
  {"date": "2026-02-25", "severity": 7},
  {"date": "2026-02-26", "severity": 6}
]
```

Clayton modifies `severity_trends` output to match.

**Lock this down at 7pm. Don't change it afterward.**

---

## â±ï¸ Timeline
| Time | Target |
|---|---|
| Fri ~4:00pm | Repo cloned, Docker running, Cloudflare tunnels active for local LLM, everyone SSH'd in |
| Fri 6:00pm | Each person's Phase 1 milestone done (see individual task files) |
| Fri 7:00pm | â­ 3-way Integration checkpoint â€” Noah + Clayton + Max finalize JSON contracts. (Max starts C-filter dev post-7pm) |
| Fri 9:00pm | Voice â†’ backend â†’ C-filter â†’ DB working end to end |
| Fri 11:00pm | Insights endpoint live (cached, instant), dashboard showing real data, async insight computation working |
| Sat 1:00am | Full flow works. Sleep. |
| Sat 8:00am | Polish, fix bugs, run seed script for demo data |
| Sat 11:00am | Code freeze. Rehearse demo. |
| Sat 1:00pm | ğŸ Submit |

## ğŸŒ± Demo Data Strategy
Real pattern detection needs weeks of data. You have hours.
Clayton writes a seed script Friday night that populates 30 days of fake entries with obvious baked-in patterns:
* Caffeine logged â†’ headache appears within 24 hours ~75% of the time
* Poor sleep â†’ fatigue next morning ~80% of the time
* Stress â†’ stomach ache same day ~65% of the time
* Alcohol â†’ headache next morning ~85% of the time

This makes the dashboard look compelling for judges.
Do not skip this. Real data from today won't show patterns until tomorrow. Fake data with built-in correlations makes the insights feature look genuinely useful.

## âš ï¸ VMware Gotcha
Set the VM's network adapter to Bridged mode (not NAT). This gives the VM its own IP on the WiFi so phones can reach it. Run `ip addr` on the VM to find the IP â€” write it in this README immediately.
If the venue WiFi blocks device-to-device traffic (common at hackathons), bring a cheap travel router as backup.

## ğŸ“ Task Files
- [Eli â€” Voice UI + Coordination](./tasks/ELI.md)
- [Noah â€” LLM + API Routes](./tasks/NOAH.md)
- [Clayton â€” Database + Analysis](./tasks/CLAYTON.md)
- [Max â€” Dashboard + Charts](./tasks/MAX.md)
